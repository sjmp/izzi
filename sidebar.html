<!DOCTYPE html>
<html>
<head>
<base target="_top">
  <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">
  <style>
    label 
    {
       font-weight: bold;
    }
    em
    {
       margin: 0 auto;
       display: table;
    }
    select, .button
    {
       width: 275px;
    }
    .group
    {
       border-top: solid #F8DE16 4px;
       margin-top: 10px;
       padding-top: 10px;
    }
    
  </style>
  </head>
<body>

<img src="https://raw.githubusercontent.com/sjmp/izzi/master/izzi.jpg" alt="izzi" style="max-width:100%;">

<div class="sidebar">
<em>Turn your Spreadsheets into XML!</em>
<div class="group">
  <div class="inline form-group">
    <label for="sheetsSelect">Sheet to be exported</label>
    <select name="sheetsSelect" id="sheets">

    </select>
</div>

<div id="test"></div>

<br/>
<input class="button" type="button" value="Export!" onclick="handleSelectChoice()"/>
<br/>
<input class="button" type="button" value="Close" onclick="google.script.host.close()"/>
</div>
</body>
</html>

<script type="text/javascript">

  
  google.script.run.withSuccessHandler(createOptions).getNames();
  
  function createOptions(data)
  {
     var options = "";
     for(var i=0; i < data.length; i++)
     {
        options = options + "<option value=" + data[i] +">" + data[i] + "</options>";
     }
     document.getElementById("sheets").innerHTML=options;
  }
  
  function handleSelectChoice()
  {
     var data = document.getElementById('sheets').value;
     google.script.run.export(data);
   
  }
  
</script>




